# 打卡无限（punch）

## Case 1

考虑树的情况，容易发现可以有一种移动方式，在第一时刻，点 $x$ 移动到点 $y$，点 $y$ 移动到点 $x$；在下一时刻，点 $y$ 移回到点 $x$，点 $x$ 移回到点 $y$。反复如此就可以一直移动下去。

基于贪心策略可以想到一个很简单的树形 DP，$f_i=1/0$ 表示第 $i$ 个点有没有与它的儿子匹配交换，$f_u = \begin{cases}1&\sum f_v=0\\0&\sum f_v\neq0\end{cases}$。然后累计子树答案即可。

## Case 2

考虑基环树的情况，我们可以分类讨论：

1. 环上的点轮着移动

   这种情况可以分环上每一棵子树讨论，如果一个子树的祖先没被匹配交换，就要多建一个点与其匹配。最后统计答案即可。

2. 有一条边不会被匹配

   枚举断边，用树的情况累计答案。

## Case 3

发现一个点肯定不可能既和它左边的点匹配又和它右边的点匹配，所以枚举环上的两个相连的边断开统计答案即可。

时间复杂度：$O(n)$。

